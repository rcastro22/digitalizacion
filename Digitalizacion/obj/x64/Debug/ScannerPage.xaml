<Page
    x:Class="Digitalizacion.ScannerPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Digitalizacion"
    xmlns:common="using:Digitalizacion.Common"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Page.Resources>
        <common:OutputHeightConverter x:Key="OutputHeightConverter"/>
    </Page.Resources>

    <Grid Background="{StaticResource FondoPartial}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Frame x:ConnectionId='1' Grid.RowSpan="2" x:Name="FragmentFrame" Margin="0,0,5,0" />

        <StackPanel Grid.Column="1">
            <ComboBox x:ConnectionId='7' ItemsSource="{Binding  Path=ScannerDataContext.ListOfScanners}"  
                      Header="Escáner:"
                        SelectedValue="{Binding Path=ScannerDataContext.CurrentScannerDeviceId, Mode=TwoWay}"
                        SelectedValuePath="Id"
                        DisplayMemberPath="Name"
                        x:Name="ScannerComboBox" HorizontalAlignment="Stretch" />
            <ToggleSwitch x:ConnectionId='8' Header="Doble cara" IsOn="True" x:Name="tggDuplex" />
            <ComboBox x:ConnectionId='9' ItemsSource="{Binding  Path=ScannerDataContext.ListOfSizes}"  
                        SelectedValue="{Binding Path=ScannerDataContext.CurrentSize, Mode=TwoWay}"
                        SelectedValuePath="Tipo"
                      Header="Tamaño de papel"
                        DisplayMemberPath="Nombre"
                        x:Name="PapelComboBox" HorizontalAlignment="Stretch" />
            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                <Button x:ConnectionId='10' x:Name="StartScenario" 
                        Content="Escanear" 
                        Margin="0,0,5,0"
                        IsEnabled="{Binding IsScanningAllowed}"
                                                   />
                <Button x:ConnectionId='11' x:Name="CancelScenario"  Content="Cancelar" 
                        IsEnabled="{Binding ScenarioRunning}"
                        Margin="5,0,0,0"
                                                    />
            </StackPanel>
            <TextBlock Text="Imagen escaneada"/>
        </StackPanel>

        <Image x:ConnectionId='2' Grid.Row="1" Grid.Column="1" Grid.RowSpan="2"
               x:Name="DisplayImage" AutomationProperties.Name="Preview of first scanned file"
               Height="{Binding ElementName=OutputSection, Path=ActualHeight,  Converter={StaticResource OutputHeightConverter}}" 
               Stretch="Fill">
        </Image>

        <Grid Grid.Row="2" Margin="0,10,5,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.Resources>
                <DataTemplate x:Key="ScanerItemsTemplate">
                    <StackPanel Margin="0,0,0,0">
                        <TextBlock Text="{Binding Name}"/>
                    </StackPanel>
                </DataTemplate>
            </Grid.Resources>

            <Button x:ConnectionId='3' Grid.ColumnSpan="2" Margin="0,5,0,5"
                    x:Name="btnCombinar"                          
                    IsEnabled="{Binding IsMergeAllowed}"
                    HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                    Content="Unir">
            </Button>

            <Button x:ConnectionId='4' Grid.Row="1" Grid.Column="0" FontSize="36" Margin="0,5,5,5"
                    x:Name="btnFinalizar"                           
                    IsEnabled="{Binding Path=IsSaveAllowed, Mode=OneWay}"
                    HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                <Button.Content>
                    <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE105;" />
                </Button.Content>
            </Button>
            <Button x:ConnectionId='5' Grid.Row="1" Grid.Column="1" FontSize="36" Margin="0,5,0,5"
                    x:Name="btnCancelar"                          
                    IsEnabled="{Binding Path=IsDeleteAllowed, Mode=OneWay}"
                    HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                <Button.Content>
                    <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE107;" />
                </Button.Content>
            </Button>
            <TextBlock Grid.Row="2" Grid.ColumnSpan="2"
                       Margin="0,10,0,10"
                       Text="Lista de imágenes a digitalizar:" />
            <ListView x:ConnectionId='6' Grid.Row="3" Grid.ColumnSpan="2"
                      x:Name="ScanerListView"
                      Background="{StaticResource FondoList}"
                      ItemsSource="{Binding FileList}"
                      ItemTemplate="{StaticResource ScanerItemsTemplate}"
                      SelectionMode="Single"
                      CanReorderItems="True" AllowDrop="True"
                                                      
                      IsRightTapEnabled="True"
                                                              
                                                                        >
            </ListView>
        </Grid>

    </Grid>
</Page>

